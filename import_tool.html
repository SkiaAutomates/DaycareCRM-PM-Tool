
<!DOCTYPE html>
<html>
<head>
    <title>Import Data</title>
    <link rel="stylesheet" href="index.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/data.js"></script>
    <style>
        body { padding: 40px; font-family: sans-serif; }
        .log { background: #f5f5f5; padding: 20px; border-radius: 8px; max-height: 500px; overflow-y: auto; font-family: monospace; }
        .success { color: green; }
        .error { color: red; }
        .warning { color: orange; }
        .info { color: blue; }
    </style>
</head>
<body>
    <h1>Data Import Tool v3</h1>
    <p>Ready to import 83 records (unfiltered).</p>
    <button id="btnImport" class="btn btn-primary" onclick="startImport()">Start Import</button>
    <div id="log" class="log" style="margin-top: 20px;"></div>

    <script>
    const RAW_DATA = [{"firstName": "Bennett", "lastName": "Michal", "dateOfBirth": "2025-02-26", "enrollmentDate": "2025-08-18", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-08-18"}, "parents": [{"firstName": "Eric", "lastName": "Michal", "email": "esmichal@gmail.com", "phone": null}, {"firstName": "Sara", "lastName": "Michal", "email": "themichalfam@gmail.com", "phone": null}], "classroom": "Silly Starfish"}, {"firstName": "Ezra Rahim", "lastName": "Merali", "dateOfBirth": "2025-07-03", "enrollmentDate": "2025-10-01", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Part Time", "daysOfWeek": ["Friday", "Thursday", "Wednesday"], "startDate": "2025-10-01"}, "parents": [{"firstName": "Jameel", "lastName": "Merali", "email": "jameelmerali1992@gmail.com", "phone": null}, {"firstName": "Olivia", "lastName": "Parker", "email": "p.oliviajane@gmail.com", "phone": null}], "classroom": "Silly Starfish"}, {"firstName": "George", "lastName": "McKee", "dateOfBirth": "2025-01-25", "enrollmentDate": "2025-07-15", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-07-15"}, "parents": [{"firstName": "Grace", "lastName": "Mariucci", "email": "gracemariucci@gmail.com", "phone": null}, {"firstName": "Tom", "lastName": "McKee", "email": "tom.j.mckee@gmail.com", "phone": null}], "classroom": "Silly Starfish"}, {"firstName": "Mina", "lastName": "Leopold", "dateOfBirth": "2025-07-07", "enrollmentDate": "2025-11-01", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-11-01"}, "parents": [{"firstName": "Yen", "lastName": "Leopold", "email": "yenleopold@gmail.com", "phone": null}, {"firstName": "Andrew", "lastName": "Leopold", "email": "auleopold@gmail.com", "phone": null}], "classroom": "Silly Starfish"}, {"firstName": "Jacob", "lastName": "Rogers", "dateOfBirth": "2025-03-13", "enrollmentDate": "2025-01-05", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": true, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-01-05"}, "parents": [{"firstName": "Rowena", "lastName": "Fontanos", "email": "rowenafontanosrogers@gmail.com", "phone": null}, {"firstName": "Kyle", "lastName": "Rogers", "email": "kylejosephrogers@gmail.com", "phone": null}], "classroom": "Silly Starfish"}, {"firstName": "Robin", "lastName": "Yee", "dateOfBirth": "2025-11-05", "enrollmentDate": "2026-02-06", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": true, "schedule": {"type": "Part Time", "daysOfWeek": ["Monday", "Wednesday", "Friday"], "startDate": "2026-02-06"}, "parents": [], "classroom": null}, {"firstName": "Emma", "lastName": "Suarez", "dateOfBirth": "2024-09-11", "enrollmentDate": "2026-02-04", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": true, "schedule": {"type": "Part Time", "daysOfWeek": ["Monday", "Wednesday", "Friday"], "startDate": "2026-02-04"}, "parents": [{"firstName": "Marijose", "lastName": "Garcia", "email": "marijosegarcia8@gmail.com", "phone": null}, {"firstName": "Andres", "lastName": "Suarez", "email": "amsp3sec@gmail.com", "phone": null}], "classroom": "Silly Starfish"}, {"firstName": "George", "lastName": "Lichtenberg", "dateOfBirth": "2025-04-15", "enrollmentDate": "2026-02-03", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": true, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2026-02-03"}, "parents": [{"firstName": "David", "lastName": "Lichtenberg", "email": "twines.bind3f@icloud.com", "phone": null}, {"firstName": "Adrien", "lastName": "Clay", "email": "adrienlouise@gmail.com", "phone": null}], "classroom": "Silly Starfish"}, {"firstName": "Aadya", "lastName": "Pani", "dateOfBirth": "2024-07-08", "enrollmentDate": "2025-07-07", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-07-07"}, "parents": [{"firstName": "Anup", "lastName": "Pani", "email": "anuppani@gmail.com", "phone": null}, {"firstName": "Kristen", "lastName": "Ganshorn", "email": "krmg06@gmail.com", "phone": null}], "classroom": "Tiny Turtles"}, {"firstName": "Arielle", "lastName": "Eisenman", "dateOfBirth": "2025-01-05", "enrollmentDate": "2025-01-05", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-01-05"}, "parents": [{"firstName": "Alice", "lastName": "Eisenman", "email": "aliceceisenman@gmail.com", "phone": null}, {"firstName": "Peter", "lastName": "Eisenman", "email": "paeisenman@gmail.com", "phone": null}], "classroom": "Silly Starfish"}, {"firstName": "Carson", "lastName": "Happel", "dateOfBirth": "2025-01-07", "enrollmentDate": "2025-07-07", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-07-07"}, "parents": [{"firstName": "Adam", "lastName": "Happel", "email": "ajhapps@gmail.com", "phone": null}, {"firstName": "Louise", "lastName": "Doyle", "email": "louisebeebedoyle@gmail.com", "phone": null}], "classroom": "Silly Starfish"}, {"firstName": "Francis", "lastName": "Cohen", "dateOfBirth": "2024-08-18", "enrollmentDate": "2025-08-11", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-08-11"}, "parents": [{"firstName": "Beth", "lastName": "Watts", "email": "bethrwatts@gmail.com", "phone": null}, {"firstName": "Michael", "lastName": "Cohen", "email": "mkc1000@gmail.com", "phone": null}], "classroom": "Tiny Turtles"}, {"firstName": "Harold", "lastName": "Proehl-Steiner", "dateOfBirth": "2024-07-22", "enrollmentDate": "2024-02-02", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2024-02-02"}, "parents": [{"firstName": "Sarah", "lastName": "Proehl", "email": "scproehl@gmail.com", "phone": null}, {"firstName": "Paul", "lastName": "Steiner", "email": "paul.jamesen@gmail.com", "phone": null}], "classroom": "Tiny Turtles"}, {"firstName": "Miles", "lastName": "Hoffman", "dateOfBirth": "2024-07-17", "enrollmentDate": "2024-10-02", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Part Time", "daysOfWeek": ["Monday", "Wednesday", "Friday"], "startDate": "2024-10-02"}, "parents": [{"firstName": "Lindsey", "lastName": "Hansen", "email": "thefuturepaststudio@gmail.com", "phone": null}, {"firstName": "Byron", "lastName": "Hoffman", "email": "byron@offsetpartners.com", "phone": "14158103020.0"}], "classroom": "Tiny Turtles"}, {"firstName": "Maddalena Giomi", "lastName": "Deamer", "dateOfBirth": "2024-10-12", "enrollmentDate": "2025-04-07", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Part Time", "daysOfWeek": ["Monday", "Wednesday", "Friday"], "startDate": "2025-04-07"}, "parents": [{"firstName": "Annie", "lastName": "Giomi", "email": "agiomi@wsgr.com", "phone": null}, {"firstName": "Michael", "lastName": "Deamer", "email": "mikedeamer@gmail.com", "phone": null}], "classroom": "Tiny Turtles"}, {"firstName": "Madeline", "lastName": "Herse", "dateOfBirth": "2024-07-09", "enrollmentDate": "2025-01-06", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-01-06"}, "parents": [{"firstName": "Erin", "lastName": "Herse", "email": "erindaniellemurphy@gmail.com", "phone": null}, {"firstName": "Nate", "lastName": "Herse", "email": "nateherse@gmail.com", "phone": "15209715050.0"}], "classroom": "Tiny Turtles"}, {"firstName": "Parker", "lastName": "DeBattista", "dateOfBirth": "2024-11-17", "enrollmentDate": "2025-08-18", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-08-18"}, "parents": [{"firstName": "Eloise", "lastName": "Libre", "email": "eloiselibre@gmail.com", "phone": null}, {"firstName": "Brad", "lastName": "DeBattista", "email": "brad.debattista@gmail.com", "phone": null}], "classroom": "Silly Starfish"}, {"firstName": "Renata", "lastName": "Wolfe", "dateOfBirth": "2024-08-01", "enrollmentDate": "2025-05-06", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-05-06"}, "parents": [{"firstName": "Alessandra", "lastName": "Kortenhorst", "email": "alessandra.kortenhorst@gmail.com", "phone": "(303) 720-5980"}, {"firstName": "Spencer", "lastName": "Wolfe", "email": "wolfesp18@gmail.com", "phone": null}], "classroom": "Tiny Turtles"}, {"firstName": "Roman", "lastName": "Ramirez", "dateOfBirth": "2024-08-16", "enrollmentDate": "2025-08-18", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-08-18"}, "parents": [{"firstName": "Matthew", "lastName": "Ramirez", "email": "matt@rscminc.com", "phone": null}, {"firstName": "Teera", "lastName": "Nuntaworanuch", "email": "teera.nunta@gmail.com", "phone": null}], "classroom": "Tiny Turtles"}, {"firstName": "Adrian", "lastName": "Casotti", "dateOfBirth": "2024-02-03", "enrollmentDate": "2023-06-15", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2023-06-15"}, "parents": [{"firstName": "Sylvana", "lastName": "Tunesi", "email": "sylvana.tunesi@gmail.com", "phone": "+19522507944"}, {"firstName": "Vincent", "lastName": "Casotti", "email": "vincent.casotti@gmail.com", "phone": "19257852180.0"}], "classroom": "Proud Penguins"}, {"firstName": "Arlo", "lastName": "Wai", "dateOfBirth": "2023-09-14", "enrollmentDate": "2024-10-16", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Part Time", "daysOfWeek": ["Thursday", "Wednesday", "Tuesday"], "startDate": "2024-10-16"}, "parents": [{"firstName": "Hillary", "lastName": "Clark", "email": "hllryclrk@gmail.com", "phone": null}, {"firstName": "Felix", "lastName": "Wai", "email": "felixhwai@gmail.com", "phone": "9014966918.0"}], "classroom": "Proud Penguins"}, {"firstName": "Elijah", "lastName": "Patel", "dateOfBirth": "2023-10-07", "enrollmentDate": "2023-01-09", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2023-01-09"}, "parents": [{"firstName": "Cindy", "lastName": "Shibutani", "email": "cshibpatel@gmail.com", "phone": null}, {"firstName": "Yash", "lastName": "Patel", "email": "yashpatel135@gmail.com", "phone": "19258905563.0"}], "classroom": "Proud Penguins"}, {"firstName": "Esti", "lastName": "Lim", "dateOfBirth": "2024-03-12", "enrollmentDate": "2024-01-02", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2024-01-02"}, "parents": [{"firstName": "Jodi", "lastName": "Frankel", "email": "jodi.frankel@gmail.com", "phone": "+17175743838"}, {"firstName": "Simon", "lastName": "Lim", "email": "lim.simonc@gmail.com", "phone": "14153956645.0"}], "classroom": "Proud Penguins"}, {"firstName": "Francis", "lastName": "Mulcahy", "dateOfBirth": "2023-12-11", "enrollmentDate": "2024-04-24", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2024-04-24"}, "parents": [{"firstName": "Chelsea", "lastName": "Mulcahy", "email": "davisc460@gmail.com", "phone": "+12487657753"}, {"firstName": "Brendan", "lastName": "Mulcahy", "email": "bmulcahy@ymail.com", "phone": "17347485496.0"}], "classroom": "Proud Penguins"}, {"firstName": "Genevieve", "lastName": "Boyd", "dateOfBirth": "2024-05-05", "enrollmentDate": "2025-09-01", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-09-01"}, "parents": [{"firstName": "Christopher", "lastName": "Boyd", "email": "christopher.ed.boyd@gmail.com", "phone": null}], "classroom": "Proud Penguins"}, {"firstName": "Maeva", "lastName": "Abolfathi", "dateOfBirth": "2024-04-04", "enrollmentDate": "2023-04-01", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2023-04-01"}, "parents": [{"firstName": "Elsa", "lastName": "Friscira", "email": "elsa.friscira@gmail.com", "phone": null}, {"firstName": "Elsa", "lastName": "Friscira", "email": "elsa.friscira@icloud.com", "phone": null}, {"firstName": "Dersu", "lastName": "Abolfathi", "email": "dersua@me.com", "phone": ""}], "classroom": "Proud Penguins"}, {"firstName": "Maya", "lastName": "Kwei-Moss", "dateOfBirth": "2024-06-21", "enrollmentDate": "2025-07-15", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-07-15"}, "parents": [{"firstName": "Anne", "lastName": "Kwei", "email": "anne.kwei@gmail.com", "phone": null}, {"firstName": "Evan", "lastName": "Moss", "email": "evanmoss@umich.edu", "phone": null}], "classroom": "Tiny Turtles"}, {"firstName": "Ollie", "lastName": "Bastian", "dateOfBirth": "2024-05-02", "enrollmentDate": "2024-06-17", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2024-06-17"}, "parents": [{"firstName": "John", "lastName": "Bastian", "email": "bastian2@gmail.com", "phone": null}, {"firstName": "Amy", "lastName": "Henning", "email": "amyvhenning@gmail.com", "phone": null}], "classroom": "Proud Penguins"}, {"firstName": "Oslo", "lastName": "Fijolek", "dateOfBirth": "2024-01-29", "enrollmentDate": "2024-04-08", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2024-04-08"}, "parents": [{"firstName": "Jessica", "lastName": "Fijolek", "email": "jess.fij@gmail.com", "phone": "+16307151852"}, {"firstName": "Ian", "lastName": "Fijolek", "email": "ian@iamthefij.com", "phone": "19203456535.0"}], "classroom": "Proud Penguins"}, {"firstName": "Theo Callejo", "lastName": "Owen", "dateOfBirth": "2024-06-17", "enrollmentDate": "2024-11-21", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2024-11-21"}, "parents": [{"firstName": "Alicia", "lastName": "Callejo-Black", "email": "acallejoblack@gmail.com", "phone": null}, {"firstName": "Devin", "lastName": "Owen", "email": "devinowen@gmail.com", "phone": "19709034938.0"}], "classroom": "Tiny Turtles"}, {"firstName": "Yuritzi", "lastName": "Chapman-Ruiz", "dateOfBirth": "2024-04-04", "enrollmentDate": "2025-09-16", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": true, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-09-16"}, "parents": [{"firstName": "Helen", "lastName": "Alfaro-Ruiz", "email": "helenachapman2124@gmail.com", "phone": null}, {"firstName": "Carter", "lastName": "Chapman", "email": "carterchapman64@gmail.com", "phone": null}], "classroom": "Proud Penguins"}, {"firstName": "Adaline", "lastName": "Williams", "dateOfBirth": "2023-06-27", "enrollmentDate": "2025-10-16", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-10-16"}, "parents": [{"firstName": "Megan", "lastName": "Conroy", "email": "meganlconroy@gmail.com", "phone": null}, {"firstName": "Maxwell James", "lastName": "Williams", "email": "maxwell.james.williams@gmail.com", "phone": null}], "classroom": "One-of-a-Kind Otters"}, {"firstName": "Ava", "lastName": "Foster", "dateOfBirth": "2023-03-11", "enrollmentDate": "2025-01-07", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-01-07"}, "parents": [{"firstName": "Haley", "lastName": "Foster", "email": "haleytfoster@gmail.com", "phone": "13108008272.0"}, {"firstName": "Michael", "lastName": "Foster", "email": "mf0414@gmail.com", "phone": null}], "classroom": "One-of-a-Kind Otters"}, {"firstName": "Flynn", "lastName": "Bussing", "dateOfBirth": "2022-10-26", "enrollmentDate": "2023-02-01", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Part Time", "daysOfWeek": ["Monday", "Wednesday", "Tuesday"], "startDate": "2023-02-01"}, "parents": [{"firstName": "Joe", "lastName": "Bussing", "email": "j.bussin@gmail.com", "phone": null}, {"firstName": "Courtney", "lastName": "Bussing", "email": "court.bussing@gmail.com", "phone": "16282344877.0"}], "classroom": "One-of-a-Kind Otters"}, {"firstName": "Ira", "lastName": "Leopold", "dateOfBirth": "2022-12-02", "enrollmentDate": "2023-04-01", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2023-04-01"}, "parents": [{"firstName": "Andrew", "lastName": "Leopold", "email": "auleopold@gmail.com", "phone": null}, {"firstName": "Yen", "lastName": "Leopold", "email": "yenleopold@gmail.com", "phone": null}], "classroom": "One-of-a-Kind Otters"}, {"firstName": "Kiera", "lastName": "Donlin", "dateOfBirth": "2022-09-13", "enrollmentDate": "2023-08-21", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2023-08-21"}, "parents": [{"firstName": "Matt", "lastName": "Books", "email": "mattebooks@gmail.com", "phone": null}, {"firstName": "Chelsea", "lastName": "Donlin", "email": "donlin.chelsea@gmail.com", "phone": null}], "classroom": "One-of-a-Kind Otters"}, {"firstName": "Louisa", "lastName": "Heermann", "dateOfBirth": "2023-07-20", "enrollmentDate": "2024-04-08", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2024-04-08"}, "parents": [{"firstName": "Justin", "lastName": "Heermann", "email": "justin.heermann@gmail.com", "phone": null}, {"firstName": "Ashley", "lastName": "Heermann", "email": "ashleyboots1@gmail.com", "phone": null}], "classroom": "One-of-a-Kind Otters"}, {"firstName": "Luca", "lastName": "Lappa", "dateOfBirth": "2023-08-16", "enrollmentDate": "2024-01-10", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2024-01-10"}, "parents": [{"firstName": "Christina", "lastName": "Hollander", "email": "christina.hollander@gmail.com", "phone": "+16507877657"}, {"firstName": "Daniel", "lastName": "Lappa", "email": "daniel.lappa@gmail.com", "phone": null}], "classroom": "One-of-a-Kind Otters"}, {"firstName": "Rupert", "lastName": "Cohen", "dateOfBirth": "2023-01-18", "enrollmentDate": "2024-07-22", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2024-07-22"}, "parents": [{"firstName": "Beth", "lastName": "Watts", "email": "bethrwatts@gmail.com", "phone": null}, {"firstName": "Michael", "lastName": "Cohen", "email": "mkc1000@gmail.com", "phone": "14159632163.0"}], "classroom": "One-of-a-Kind Otters"}, {"firstName": "Summer", "lastName": "Ramirez", "dateOfBirth": "2022-07-13", "enrollmentDate": "2024-04-20", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2024-04-20"}, "parents": [{"firstName": "Teera", "lastName": "Nuntaworanuch", "email": "teera.nunta@gmail.com", "phone": null}, {"firstName": "Matthew", "lastName": "Ramirez", "email": "matt@rscminc.com", "phone": "16618638782.0"}], "classroom": "One-of-a-Kind Otters"}, {"firstName": "Wilder", "lastName": "Welsh", "dateOfBirth": "2023-08-24", "enrollmentDate": "2024-02-12", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2024-02-12"}, "parents": [{"firstName": "Tali", "lastName": "Leff", "email": "talikatina@gmail.com", "phone": null}, {"firstName": "Alex", "lastName": "Welsh", "email": "adwelsh@gmail.com", "phone": "14142182429.0"}], "classroom": "Proud Penguins"}, {"firstName": "Brandon Masaharu", "lastName": "Osaki", "dateOfBirth": "2022-02-24", "enrollmentDate": "2022-07-05", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2022-07-05"}, "parents": [{"firstName": "Wendy", "lastName": "Osaki", "email": "designerw@hotmail.com", "phone": null}, {"firstName": "Bryan", "lastName": "Osaki", "email": "bryan.osaki@yahoo.com", "phone": "16502014703.0"}], "classroom": "Dancing Dolphins/Wonderful Whales"}, {"firstName": "Hans Anderson", "lastName": "Duca", "dateOfBirth": "2021-07-15", "enrollmentDate": "2024-12-02", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2024-12-02"}, "parents": [{"firstName": "Simona", "lastName": "Duca", "email": "constantinescu.simona@gmail.com", "phone": "+14154253820"}, {"firstName": "Andrei", "lastName": "Duca", "email": "duca.andrei@gmail.com", "phone": ""}], "classroom": "Dancing Dolphins"}, {"firstName": "Kai", "lastName": "Patel", "dateOfBirth": "2021-12-19", "enrollmentDate": "2024-02-12", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2024-02-12"}, "parents": [{"firstName": "Cindy", "lastName": "Shibutani", "email": "cshibpatel@gmail.com", "phone": null}, {"firstName": "Yash", "lastName": "Patel", "email": "yashpatel135@gmail.com", "phone": "19258905563.0"}], "classroom": "Dancing Dolphins/Wonderful Whales"}, {"firstName": "Leonor", "lastName": "Williams", "dateOfBirth": "2021-07-21", "enrollmentDate": "2025-10-16", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-10-16"}, "parents": [{"firstName": "Megan", "lastName": "Conroy", "email": "meganlconroy@gmail.com", "phone": null}, {"firstName": "Maxwell James", "lastName": "Williams", "email": "maxwell.james.williams@gmail.com", "phone": null}], "classroom": "Dancing Dolphins/Wonderful Whales"}, {"firstName": "Ronan", "lastName": "Heerman", "dateOfBirth": "2021-07-17", "enrollmentDate": "2024-03-01", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2024-03-01"}, "parents": [], "classroom": null}, {"firstName": "Parth", "lastName": "Kowdle", "dateOfBirth": "2022-09-27", "enrollmentDate": "2026-02-09", "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2026-02-09"}, "parents": [{"firstName": "Adarsh", "lastName": "Kowdle", "email": "gauriadarsh86@gmail.com", "phone": ""}, {"firstName": "Gauri Shri", "lastName": "Anantha", "email": "", "phone": "15416999359.0"}], "classroom": "One-of-a-Kind Otters"}, {"firstName": "Enrollment", "lastName": "Process", "dateOfBirth": null, "enrollmentDate": null, "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Regular", "daysOfWeek": null, "startDate": null}, "parents": [], "classroom": null}, {"firstName": "1. Create New Tab- labeled", "lastName": "Month/Year", "dateOfBirth": null, "enrollmentDate": null, "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Regular", "daysOfWeek": null, "startDate": null}, "parents": [], "classroom": null}, {"firstName": "2. Copy and paste last month to new", "lastName": "one", "dateOfBirth": null, "enrollmentDate": null, "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Regular", "daysOfWeek": null, "startDate": null}, "parents": [], "classroom": null}, {"firstName": "3. Delete Leaving", "lastName": "Students", "dateOfBirth": null, "enrollmentDate": null, "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Regular", "daysOfWeek": null, "startDate": null}, "parents": [], "classroom": null}, {"firstName": "4. Update New Leaving", "lastName": "Students", "dateOfBirth": null, "enrollmentDate": null, "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Regular", "daysOfWeek": null, "startDate": null}, "parents": [], "classroom": null}, {"firstName": "5. Move transitioning", "lastName": "Students", "dateOfBirth": null, "enrollmentDate": null, "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Regular", "daysOfWeek": null, "startDate": null}, "parents": [], "classroom": null}, {"firstName": "6. Update Transitioning", "lastName": "Dates", "dateOfBirth": null, "enrollmentDate": null, "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Regular", "daysOfWeek": null, "startDate": null}, "parents": [], "classroom": null}, {"firstName": "7. Input Incoming", "lastName": "Students", "dateOfBirth": null, "enrollmentDate": null, "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Regular", "daysOfWeek": null, "startDate": null}, "parents": [], "classroom": null}, {"firstName": "8. Updated Weekly", "lastName": "Schedule", "dateOfBirth": null, "enrollmentDate": null, "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Regular", "daysOfWeek": null, "startDate": null}, "parents": [], "classroom": null}, {"firstName": "9. Confirm Spacing", "lastName": "#'s", "dateOfBirth": null, "enrollmentDate": null, "location": "Day Care Location 1", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Regular", "daysOfWeek": null, "startDate": null}, "parents": [], "classroom": null}, {"firstName": "Cameron", "lastName": "Velasco", "dateOfBirth": "2025-08-05", "enrollmentDate": "2026-11-02", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2026-11-02"}, "parents": [], "classroom": null}, {"firstName": "Eloise", "lastName": "McAndrew", "dateOfBirth": "2024-08-22", "enrollmentDate": "2025-09-15", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-09-15"}, "parents": [{"firstName": "Whitney", "lastName": "McAndrew", "email": "whitneymcandrew@gmail.com", "phone": null}, {"firstName": "(424) 410-9889", "lastName": "John", "email": "McAndrew", "phone": null}], "classroom": "Infant Classroom"}, {"firstName": "Emilia", "lastName": "Vaivada", "dateOfBirth": "2024-12-28", "enrollmentDate": "2025-08-18", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-08-18"}, "parents": [{"firstName": "Jurgita", "lastName": "Pupeikiene", "email": "gita622@outlook.com", "phone": null}, {"firstName": "(650) 578-1083", "lastName": "Jurgita", "email": "Pupeikiene", "phone": null}], "classroom": "Infant Classroom"}, {"firstName": "Jonas", "lastName": "Koskinen", "dateOfBirth": "2025-03-21", "enrollmentDate": "2025-10-14", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-10-14"}, "parents": [{"firstName": "Erica", "lastName": "Eilenberg", "email": "erica.eilenberg2@gmail.com", "phone": null}, {"firstName": "(907) 750-2205", "lastName": "Alex", "email": "Koskinen", "phone": null}], "classroom": "Infant Classroom"}, {"firstName": "Jude", "lastName": "Piakis", "dateOfBirth": "2025-05-29", "enrollmentDate": "2025-10-14", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-10-14"}, "parents": [{"firstName": "Seana", "lastName": "Piakis", "email": "Seanaplusjon@gmail.com", "phone": null}, {"firstName": "(623) 332-4688", "lastName": "Jonathan", "email": "Piakis", "phone": null}], "classroom": "Infant Classroom"}, {"firstName": "Kylan", "lastName": "Lee", "dateOfBirth": "2025-04-23", "enrollmentDate": "2025-01-11", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Part Time", "daysOfWeek": ["Monday", "Tuesday", "Friday"], "startDate": "2025-01-11"}, "parents": [{"firstName": "Carrie", "lastName": "Chan", "email": "Carrietchan@gmail.com", "phone": null}, {"firstName": "6504410975", "lastName": "Kenny", "email": "Lee", "phone": null}], "classroom": "Infant Classroom"}, {"firstName": "Margot", "lastName": "Qi", "dateOfBirth": "2025-04-16", "enrollmentDate": "2026-05-01", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2026-05-01"}, "parents": [{"firstName": "Tianyu Ross", "lastName": "Qi", "email": "tianyuqi@gmail.com", "phone": null}, {"firstName": "(217) 721-1009", "lastName": "Valerie", "email": "Qi", "phone": null}], "classroom": "Infant Classroom"}, {"firstName": "Mason Lucas", "lastName": "Tan", "dateOfBirth": "2024-12-27", "enrollmentDate": "2025-01-09", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-01-09"}, "parents": [{"firstName": "Bowen", "lastName": "Tan", "email": "bowentan404@yahoo.com", "phone": null}], "classroom": "Infant Classroom"}, {"firstName": "Noah", "lastName": "Kattouw", "dateOfBirth": "2024-07-09", "enrollmentDate": "2025-02-06", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-02-06"}, "parents": [{"firstName": "Caitlin", "lastName": "Kattouw", "email": "caitlin.e.reardon@gmail.com", "phone": null}], "classroom": "Infant Classroom"}, {"firstName": "Paxton", "lastName": "Eusebio", "dateOfBirth": "2025-01-25", "enrollmentDate": "2025-05-05", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Part Time", "daysOfWeek": ["Monday", "Thursday", "Friday"], "startDate": "2025-05-05"}, "parents": [{"firstName": "Francis", "lastName": "Eusebio", "email": "francis.r.eusebio@gmail.com", "phone": null}], "classroom": "Infant Classroom"}, {"firstName": "Zaia", "lastName": "Chang", "dateOfBirth": "2025-02-26", "enrollmentDate": "2025-01-10", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-01-10"}, "parents": [{"firstName": "Esther", "lastName": "Pak", "email": "epak86@gmail.com", "phone": null}, {"firstName": "6503020231", "lastName": "Josh", "email": "Chang", "phone": null}], "classroom": "Infant Classroom"}, {"firstName": "Ioanna", "lastName": "Ntranos", "dateOfBirth": "2025-05-21", "enrollmentDate": "2025-10-15", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-10-15"}, "parents": [{"firstName": "Vasilis", "lastName": "Ntranos", "email": "vntranos@gmail.com", "phone": null}, {"firstName": "310-709-4385", "lastName": "Hara", "email": "Apostolopoulou", "phone": null}], "classroom": "Infant Classroom"}, {"firstName": "Infant", "lastName": "?", "dateOfBirth": null, "enrollmentDate": null, "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": null}, "parents": [], "classroom": null}, {"firstName": "Alejandra", "lastName": "Genyk", "dateOfBirth": "2023-10-16", "enrollmentDate": "2025-01-01", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-01-01"}, "parents": [{"firstName": "Yuri", "lastName": "Genyk", "email": "ygenyk24@gmail.com", "phone": null}, {"firstName": "16262151200", "lastName": "Radhika", "email": "Thakur", "phone": null}], "classroom": "Toddler Classroom"}, {"firstName": "Connor", "lastName": "Kane", "dateOfBirth": "2023-10-13", "enrollmentDate": "2025-03-24", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-03-24"}, "parents": [{"firstName": "Bobby (Robert)", "lastName": "Kane", "email": "rskane333@gmail.com", "phone": null}, {"firstName": "4153173334", "lastName": "Jackie", "email": "Miller", "phone": null}], "classroom": "Toddler Classroom"}, {"firstName": "Eloise", "lastName": "Bornstein", "dateOfBirth": "2024-07-07", "enrollmentDate": "2025-01-21", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-01-21"}, "parents": [], "classroom": null}, {"firstName": "Filippos", "lastName": "Sarilakis", "dateOfBirth": "2023-11-17", "enrollmentDate": "2025-06-01", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-06-01"}, "parents": [{"firstName": "Nikos", "lastName": "Sarilakis", "email": "nsarilakis@gmail.com", "phone": null}], "classroom": "Toddler Classroom"}, {"firstName": "Georges", "lastName": "Etcheparre", "dateOfBirth": "2023-07-06", "enrollmentDate": "2024-01-08", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2024-01-08"}, "parents": [{"firstName": "Marie", "lastName": "Etcheparre", "email": "mg.etcheparre@gmail.com", "phone": null}, {"firstName": "14152608236", "lastName": "Mathieu", "email": "Etcheparre", "phone": null}], "classroom": "Toddler Classroom"}, {"firstName": "George", "lastName": "Horwood", "dateOfBirth": "2024-03-15", "enrollmentDate": "2025-03-17", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-03-17"}, "parents": [{"firstName": "Hannah", "lastName": "Ormshaw", "email": "hormshaw@gmail.com", "phone": null}, {"firstName": "1 (415) 530-1560", "lastName": "Keith", "email": "Horwood", "phone": null}], "classroom": "Toddler Classroom"}, {"firstName": "Jack", "lastName": "McCarthy", "dateOfBirth": "2024-06-04", "enrollmentDate": "2024-01-04", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2024-01-04"}, "parents": [{"firstName": "Boddy", "lastName": "McCarthy", "email": "mccarthybobby@gmail.com", "phone": null}, {"firstName": "1 (415) 999-0500", "lastName": "Crystal", "email": "Smith", "phone": null}], "classroom": "Toddler Classroom"}, {"firstName": "Luca", "lastName": "Keensombath", "dateOfBirth": "2024-06-07", "enrollmentDate": "2025-01-21", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2025-01-21"}, "parents": [{"firstName": "Victoria", "lastName": "Khamsombath", "email": "keensombath@gmail.com", "phone": null}, {"firstName": "19787264900", "lastName": "", "email": "", "phone": null}], "classroom": "Infant Classroom"}, {"firstName": "Kenji", "lastName": "Albring", "dateOfBirth": "2024-05-21", "enrollmentDate": "2025-06-01", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Part Time", "daysOfWeek": ["Monday", "Thursday", "Tuesday"], "startDate": "2025-06-01"}, "parents": [{"firstName": "Tim", "lastName": "Albring", "email": "tim.albring@googlemail.com", "phone": null}], "classroom": "Toddler Classroom"}, {"firstName": "Kiaan", "lastName": "Sharda", "dateOfBirth": "2024-01-24", "enrollmentDate": "2025-03-03", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Part Time", "daysOfWeek": ["Monday", "Wednesday", "Friday"], "startDate": "2025-03-03"}, "parents": [{"firstName": "Ankush", "lastName": "Sharda", "email": "ankusharda@gmail.com", "phone": null}, {"firstName": "(510) 434-6988", "lastName": "Dipika", "email": "Sharda", "phone": null}], "classroom": "Toddler Classroom"}, {"firstName": "Miles", "lastName": "Fonte", "dateOfBirth": "2024-01-14", "enrollmentDate": "2024-08-27", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2024-08-27"}, "parents": [{"firstName": "Amy", "lastName": "Fonte", "email": "amytfonte@gmail.com", "phone": null}, {"firstName": "16038677242", "lastName": "Tim", "email": "Fonte", "phone": null}], "classroom": "Toddler Classroom"}, {"firstName": "Remi", "lastName": "Elgin", "dateOfBirth": "2024-07-01", "enrollmentDate": "2024-07-29", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Full Time", "daysOfWeek": null, "startDate": "2024-07-29"}, "parents": [{"firstName": "Avantika", "lastName": "Elgin", "email": "avantikachitre@gmail.com", "phone": null}, {"firstName": "14083481918", "lastName": "Josh", "email": "Elgin", "phone": null}], "classroom": "Toddler Classroom"}, {"firstName": "Mason", "lastName": "Chua", "dateOfBirth": "2024-05-22", "enrollmentDate": "2026-01-21", "location": "Day Care Location 2", "status": "Enrolled", "isElfa": false, "schedule": {"type": "Part Time", "daysOfWeek": ["Monday", "Wednesday", "Friday"], "startDate": "2026-01-21"}, "parents": [{"firstName": "Julie", "lastName": "Chua", "email": "chocobo.jules@gmail.com", "phone": null}], "classroom": "Toddler Classroom"}];
    
    // Filter Data
    const IMPORT_DATA = RAW_DATA.filter(c => {
        if (!c.firstName || !c.lastName) return false;
        if (/[0-9]/.test(c.firstName)) return false; 
        if (c.firstName.includes('Current')) return false; 
        if (c.lastName === '?') return false;
        return true;
    });

    function resolveClassroom(excelName, location) {
        if (!excelName) return null;
        const classrooms = Data.CLASSROOMS;
        const cleanExcel = excelName.toLowerCase();
        
        // Filter by location first if available
        const locationMatches = classrooms.filter(c => {
            if (!location) return true; 
            return c.location.includes(location) || location.includes(c.location);
        });
        
        // 1. Exact Name match (contains)
        let match = locationMatches.find(c => cleanExcel.includes(c.name.toLowerCase()) || c.name.toLowerCase().includes(cleanExcel));
        
        // 2. Specific keywords
        if (!match) {
            if (cleanExcel.includes('starfish')) match = locationMatches.find(c => c.name.includes('Starfish'));
            else if (cleanExcel.includes('turtles')) match = locationMatches.find(c => c.name.includes('Turtles'));
            else if (cleanExcel.includes('penguin')) match = locationMatches.find(c => c.name.includes('Penguin'));
            else if (cleanExcel.includes('otters')) match = locationMatches.find(c => c.name.includes('Otters'));
            else if (cleanExcel.includes('whales') || cleanExcel.includes('dolphins')) match = locationMatches.find(c => c.name.includes('Whales'));
        }

        // 3. Fallback for Day Care Location 2 'Infant'
        if (!match && location && location.includes('Day Care Location 2') && cleanExcel.includes('infant')) {
             match = locationMatches.find(c => c.name === 'Infant Room');
        }

        return match ? match.id : null;
    }

    async function startImport() {
        const btn = document.getElementById('btnImport');
        btn.disabled = true;
        btn.innerText = 'Importing...';
        
        const log = document.getElementById('log');
        const appendLog = (msg, type='info') => {
            const div = document.createElement('div');
            div.className = type;
            div.innerHTML = msg; 
            log.appendChild(div);
            log.scrollTop = log.scrollHeight;
        };

        appendLog(`Starting import of ${IMPORT_DATA.length} cleaned records...`);
        
        try {
            await Data.init(); // Init Supabase/Local
            
            // Loop
            let counts = { parents: 0, children: 0, schedules: 0, updated: 0, skipped: 0 };
            
            for (const item of IMPORT_DATA) {
                // 1. Process Parents
                let parentIds = [];
                if (item.parents) {
                    for (const p of item.parents) {
                        if (!p.email) continue;
                        
                        // Check existence by email locally
                        const existingParents = Data.getParents();
                        let parent = existingParents.find(ep => ep.email && ep.email.toLowerCase() === p.email.toLowerCase());
                        
                        if (!parent) {
                            // Create Parent
                            parent = Data.addParent({
                                firstName: p.firstName,
                                lastName: p.lastName,
                                email: p.email,
                                phone: p.phone,
                                status: 'Active'
                            });
                            counts.parents++;
                            appendLog(`Created Parent: ${p.firstName} ${p.lastName}`, 'success');
                            await new Promise(r => setTimeout(r, 20));
                        }
                        if (parent) parentIds.push(parent.id);
                    }
                }
                
                // 2. Resolve Classroom
                const classroomId = resolveClassroom(item.classroom, item.location);
                
                // 3. Process Child
                const existingChildren = Data.getChildren();
                let child = existingChildren.find(c => 
                    c.firstName === item.firstName && 
                    c.lastName === item.lastName && 
                    c.dateOfBirth === item.dateOfBirth
                );
                
                if (!child) {
                    child = Data.addChild({
                        firstName: item.firstName,
                        lastName: item.lastName,
                        dateOfBirth: item.dateOfBirth,
                        enrollmentDate: item.enrollmentDate,
                        location: item.location,
                        status: item.status,
                        isElfa: item.isElfa,
                        scheduleType: item.schedule.type,
                        parentIds: parentIds,
                        classroomId: classroomId
                    });
                    counts.children++;
                    
                    let extra = [];
                    if (item.isElfa) extra.push('ELFA');
                    if (classroomId) extra.push(`Class: ${classroomId}`);
                    const extraStr = extra.length ? ` (${extra.join(', ')})` : '';
                    
                    appendLog(`Created Child: ${item.firstName} ${item.lastName}${extraStr}`, 'success');
                    await new Promise(r => setTimeout(r, 20)); 
                } else {
                    // Update existing child with missing info
                    let updates = {};
                    let details = [];
                    
                    if (classroomId && (!child.classroomId || child.classroomId !== classroomId)) {
                        updates.classroomId = classroomId;
                        details.push('Classroom');
                    }
                    
                    if (item.isElfa !== undefined && child.isElfa !== item.isElfa) {
                        updates.isElfa = item.isElfa;
                        details.push('ELFA');
                    }
                    
                    // Parents: Merge
                    if (parentIds.length > 0) {
                        const existingPids = child.parentIds || [];
                        // Find PIDs not in existing
                        const newPids = parentIds.filter(pid => !existingPids.includes(pid));
                        if (newPids.length > 0) {
                            updates.parentIds = [...existingPids, ...newPids];
                            details.push('Parents');
                        }
                    }
                    
                    if (Object.keys(updates).length > 0) {
                        Data.updateChild(child.id, updates);
                        appendLog(`Updated Child: ${item.firstName} (Added: ${details.join(', ')})`, 'info');
                        counts.updated++;
                        await new Promise(r => setTimeout(r, 20)); 
                    } else {
                        appendLog(`Skipped Child (Up to date): ${item.firstName}`, 'warning');
                        counts.skipped++;
                    }
                }
                
                // 4. Process Schedule
                if (child) {
                    // Check if schedule exists?
                    // Simply add latest because schedules table supports history.
                    // But prevent dupes if identical entry exists
                    // For now, always adding might clutter if re-run many times.
                    // Let's rely on basic logic.
                    // Data.addSchedule({ ... });
                    // Skip to avoid dupes in this run
                }
            }
            
            appendLog(`<br><strong>Import Complete!</strong><br>Parents Created: ${counts.parents}<br>Children Created: ${counts.children}<br>Children Updated: ${counts.updated}`, 'success');
            btn.innerText = 'Done';
            btn.disabled = false;
            
        } catch (err) {
            appendLog(`Error: ${err.message}`, 'error');
            console.error(err);
            btn.innerText = 'Failed';
        }
    }
    </script>
</body>
</html>
